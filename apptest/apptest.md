# **App测试**

###### **app测试流程**

测试计划制定->测试需求分析->测试用例设计->冒烟测试/版本接受测试->UI测试->功能测试->兼容性测试/性能测试->Bug跟踪->回归测试->验收测试->发布上线

##### App测试类型

###### **功能测试**

* 主要验证App的功能需求是否满足，是否存在遗漏缺失，实现错误等情况；
* 主要考察点：
  * 功能业务逻辑和输入输出（数据的类型、范围、边界）
  * 运行时能否正常使用（安装启动、前后台切换）
  * 免登录或离线状态使用（身份权限校验、数据传递的校验）
  * 系统自带功能的使用（电话、相册、相机、定位）

###### **UI测试**

* 主要验证页面的排版布局、文字大小、颜色搭配、空间按钮、弹框操作、图片显示等是否协调统一。与UI效果是否存在差异；
* 主要考查点：
  * 排版布局：验证产品的聚合页、列表页、内容页、功能页等设计是否协调统一；
  * 交互操作：验证产品的弹框、按钮、链接等操作交互显示是否合理；
  * 内容展示：验证内容的文字、图片显示是否正常；

###### **性能测试**

* 主要验证的是客户端在处理使用产品时所消耗的电量、流量、CPU、内存等是否正常；
* 主要考察点：
  * 耗电量：验证产品在使用过程中消耗电量的情况；比如：电量不足启动省电模式；
  * 流量消耗：验证产品在使用过程中消耗流量的情况；
  * CPU内存：验证产品使用过程中CPU的占用比，是否存在内存泄漏；

###### **兼容测试**

* 主要验证产品在不同硬件设备下是否能够正常使用，主要考虑设备品牌机型、操作系统、屏幕分辨率、网络等兼容；
* 主要考查点：
  * 品牌机型：验证产品能够兼容市面上主流的设备品牌机型；比如华为、小米、OPPO、vivo、三星、苹果等；
  * 操作系统：验证产品在主要操作系统的主流版本上能够正常使用；比如：Android系统13-15，IOS17-19；
  * 屏幕分辨率：验证产品在主流的屏幕尺寸下能够正常使用；比如2556x1179 - 2992x1344；
  * 网络兼容：验证产品在WIFI、3G、4G、5G等不同网络下能够正常使用；

###### **安装卸载测试**

* 主要验证产品能否正常安装、卸载、更新，是否存在异常情况；
  * 主要考查点：
    * 安装测试：验证产品能够正常安装，安装后不存在多余的文件；
    * 卸载测试：验证产品能够正常卸载，卸载后删除所有相关文件；
    * 更新测试：验证产品能够正常更新、跨版本更新、强制更新等；

###### **交叉事件测试**

* 主要验证产品在使用过程中，临时接收或使用系统自带应用对产品进行干扰所产生的影响；
  * 主要考察点：
    * 同时使用多个App，相互之间是否存在干扰冲突；
    * 产品前后台切换，是否影响使用；
    * 与系统自带应用产生冲突，比如电话、相机、蓝牙收发数据等；

###### **推送测试**

* 主要验证产品在使用过程中能否正常推送运营类消息或者应用自动生成的消息，关注推送的类型、频率、时间以及屏蔽后的响应；
* 主要考察：
  * 验证消息推送的业务规则是否正确：包括消息类型、推送频率、推送时间、屏蔽设置等；

###### **安全测试**

* 主要验证产品在使用中能够进行数据加密、数据存储脱敏、安全预警提示、交互中断及恢复等处理响应；
* 主要考查点：
  * 数据加密：验证数据传输过程中不以明文方式传递；
  * 数据存储脱敏：验证数据存储在指定位置，非指定位置需要脱敏处理；
  * 安全预警提示：验证产品在关键操作时进行通知提示，或预警；
  * 交互中断恢复：验证产品在交叉事件发生时，暂停当前业务，优先处理其他事件，并能事后恢复；

###### **硬件测试**

* 主要验证产品在硬件设备下使用时，能够正确处理各种便捷手势操作；在各种网络的弱网环境下，能否正确给出处理响应；

###### **缓存测试**

* 主要验证产品在使用过程中能够自动缓存数据到本地，对本地缓存数据能够进行缓存更新、删除、替换等；(增删改查)。

###### **用户体验测试（易用性测试）**

* 主要验证产品是否满足用户的体验，能够舒适，易用，友好的满足用户的使用感受；

##### **Web测试和App测试的区别**

* 相同：基本的测试流程，测试方法是相同的；
* 系统架构：
  * Web测试项目属于B/S，浏览器/服务器架构；
  * App测试项目属与C/S，客户端/服务器架构；
* 性能测试：
  * Web测试的性能主要时基于接口的性能测试（CPU、内存、并发、响应时间、TPS）；
  * App的性能测试除了考虑服务器端基于接口的性能测试外，还要考虑流量，耗电量等；
* 兼容测试方面：
  * Web测试主要考虑操作系统兼容和浏览器兼容；
  * App测试主要考虑的是设备机型、操作系统、屏幕分辨率、网络等兼容；
* 专项测试方面：
  * Web测试的专项主要针对链接、图形、打印等特殊类型测试；
  * App测试的专项主要考虑：安装卸载、设备权限、交叉事件、消息推送、网络等方面的测试；
* 测试工具方面：
  * Web测试的自动化使用Seleium
  * App测试自动化使用Appium

##### **Android测试和IOS测试的区别**

相同：主要的测试流程，测试类型，测试方法基本相同；

不同在于

* 系统兼容方面：
  * Android测试可以版本之间向下兼容；
  * IOS测试版本不能降级，版本向下兼容较差
* 操作习惯方面：
  * Android测试主要通过案件和手势进行操作；
  * IOS测试主要通过手势进行操作；
* 消息推送push方面：
  * Android测试接收push消息查看后按Home键切换到后台，可以唤醒；
  * IOS测试接收push消息后，按Home键进行关闭和锁屏；
* App的安装渠道方面：
  * Android测试的软件安装工具、渠道较多，比如谷歌应用市场、豌豆荚、91助手等；
  * IOS测试的软件安装工具只有AppStore；

##### **弱网测试**

###### **弱网测试概念**

* 主要验证产品在模拟3/4/5G  WIFI等网络下高延时，高丢包的情况下，验证 产品的容错性；
* 主要关注：
  * 产品的页面响应时间是否可接受，包括页面切换时间、前后台切换时间、首页加载时间等；
  * 产品的页面内容呈现是否完整一致；
* 测试策略：弱网功能测试、无网测试、网络切换测试、用户体验测试；

###### **弱网测试**

* Fiddle模拟弱网
  * 启用模拟调制解调器速度选项：
    点击Rules>Performances>Simulate Modem Speeds
  * 设置模拟速度：
    Rules> Customize Rules
    oSession["request-trickle-delay"] = "300";
    oSession["response-trickle-delay"] = "150";
* Charles模拟弱网
  * 设置弱网选项
    Proxy > Throttle Settings

##### **Adb Monkey 稳定性测试**

###### **环境搭建**

* Java JDK安装
  * 安装版本要求：1.8以上
  * 配置环境变量：
    * `%JAVA_HOME%\bin;%JAVA_HOME%\jre\bin`
    * `;%JAVA_HOME%\lib\dt. jar ;%JAVA_HOME%\1ib\tools. jar`
* Android SDK安装
  * 直接下载Android SDK
  * 通过Android studio，下载AndroidSDK
  * 配置环境变量
    * adb配置环境变量：D:Android\Android_SDK\platform-tools加入系统环境变量path
    * aapt命令环境变量配置；D:\Android\Android_SDK\build-tools\36.0.0
* 模拟或真机
  * 模拟器
    * Android模拟：Genymotion、夜神模拟器、逍遥安卓模拟器、雷电模拟  器、、腾讯手游助手、AVDManager.exe、天天模拟器
    * iphone模拟器电脑版、、iphone手游模拟器电脑版、ios模拟器、  BlueStacks模拟器
  * 真机
    * 数据线连通电脑和手机；
    * 手机权限设置允许外部访问；

###### adb常用命令

* db devices 查看链接设备，默认设备会自动连接;
* adb connect 设备名/IP:端口
  * adb connect 127.0.0.1:5555
  * 常见模拟器的默认端口号5555；夜神模拟：62001/52001；逍遥模拟器：21503；
* adb disconnect 断开连接
  ```
  adb connect 127.0.0.1:21503
  adb disconnect 127.0.0.1:21503
  ```
* adb shell 命令行进入模拟
* adb push 本地上传文件到模拟器
  * adb push 本地路径模拟路径
* adb pull模拟器下载文件到本地
  * adb pull模拟器路径本地路径
* adb push 本地上传文件到模拟器
* adb install/uninstall包名进行apk包的安装卸载
  * adb install-r C:\Users\93166\Downloads\fqmfxs68732.apk
  * adb uninstall com.dragon.read
* 查看包名：aapt dump badging C:\Users\93166\Downloads\fqmfxs68732.apk
* 找已安装应用包名
  * `adb shell pm list package | findstr "tencent"`
* 保存截图
  * 保存到模拟器： `adb shell screencap -p "/sdcard/aa.png"`
  * 保存到本地： `adb exec-out screencap -p > d:/aa.png`

###### **adb shell monkey命令**

完整命令格式；

`adb shell monkey 基础参数 事件参数 调试参数 1000 > 日志路径 2>&1 &`

* 基础参数
  * -p packagename1 [-p packagename2]
  * -s 12   ->  回归测试复现Bug
  * -v -v -v    ->   日志详细级别
  * --throttle 300  ->  操作延时单位毫秒
  * n     1000   操作事件的次数
* 事件参数：怎加特定操作行为占比；
  * 触摸事件：--pct-touch 10       点击事件
  * 滑动事件：--pct-motion      滚动、滑动操作
  * 轨迹事件：--pct-trackball       拖拽操作
  * 按键事件：--pct-syskeys         返回键、home键
  * 导航事件：--pct-nav        导航菜单
* 调试参数：确保稳定性测试执行完成，不被中断；
  * 忽略崩溃：--ignore-crashes
  * 忽略超时：--ignore-timeouts
  * 忽略安全异常：--ignore-security-exceptions
  * 关闭异常进程：--kill-process-after-error

###### **monkey稳定性测试策略**

* 执行每次压测时，必须设置-s    Seed值，便于进行回归复测重现Bug
* 单个apk问题测试时，设置忽略异常，便于发现更多业务方面的Bug;
* 单个apk验收测试时，必须关闭忽略异常（不带忽略异常参数）；
* 单个apk进行压力测试时，设置更小的延时时间--throttle，比如500ms以下；
* 多个apk集合测试时，把常用的App设置出来，便于验证App切换交互；
* 产品交付前，必须使用真机设备进行稳定性测试；

###### **monkey真机运行设置**

* 启用开发者模式：找到手机系统版本，点击5次，提示"启用开发者模式"；
* 启动USB调试模式：系统设置中找到"开发者选项"，启动【USB调试】
* 数据线连接：使用数据线链接手机和电脑；
* PC端cmd 命令行发送monkey指令；

##### **日志分析**

###### **错误类型**

* ANR无响应：界面响应超时5s，回调函数超时10s；
* CRASH崩溃闪退：系统资源耗尽导致，比如内存泄露；
* Exception异常：代码层面的Bug；
* Error错误：通常属于功能逻辑问题；

在日志文件中查找关键词：ANR、Crash、Exception、fatal、ForceClosed、Error、Warning；

###### **adb logcat 抓取系统日志**

* adb logcat输出内容控制台
* adb logcat > d:/aa/filename.log  输出日志到文件中
* adb logcat | findstr "keyword" > filename.log    关键字过滤保存到文件；
